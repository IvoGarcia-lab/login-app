name: Deploy Simples

on:
  push:
    branches: [main, master]

jobs:
  deploy:
    name: Deploy para Hostinger VPS
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout
        uses: actions/checkout@v3
      
      - name: ðŸš€ Deploy via SSH
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.VPS_HOST }}
          username: ${{ secrets.VPS_USERNAME }}
          key: ${{ secrets.VPS_SSH_KEY }}
          port: ${{ secrets.VPS_PORT || 22 }}
          script: |
            echo "ðŸ”„ Atualizando cÃ³digo..."
            cd ${{ secrets.VPS_APP_PATH }}
            git pull origin main
            
            echo "ðŸ“¦ Instalando dependÃªncias..."
            npm install --production
            
            echo "ðŸ”„ Reiniciando aplicaÃ§Ã£o..."
            pm2 restart login-app || pm2 start server.js --name login-app
            pm2 save
            
            echo "âœ… Deploy concluÃ­do!"
